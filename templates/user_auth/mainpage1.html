{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generate Home</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Quicksand:wght@300..700&display=swap" rel="stylesheet" />

  <!-- keep existing stylesheet -->
  <link rel="stylesheet" href="{% static 'user_auth/css/adstyle1.css' %}" />
</head>
<>
  <main class="generate-home">
    <!-- ───────────────────── Header ───────────────────── -->
    <header class="header">
      <!-- header content unchanged -->
    </header>

    <div class="main-content">
      <!-- ────────────── Left‑hand form pane ────────────── -->
      <div class="form-section">
        <section class="generate-form">
          <h1>Generate a campaign post</h1>
          <hr />

          <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- Product -->
            <div class="input-group">
              <label class="top2-input">Product / Topic</label>
              <div class="input-field">
                <input type="text" name="product"
                       placeholder="Add a product, event, campaign"
                       value="{{ form.product.value }}" required />
              </div>
            </div>

            <!-- Description -->
            <div class="input-group">
              <label class="top2-input">Description</label>
              <div class="input-field">
                <textarea name="description"
                          placeholder="Add a date, time, location or anything else"
                          required>{{ form.description.value }}</textarea>
              </div>
            </div>

            <!-- Remarks -->
            <div class="input-group">
              <label class="top2-input">Remarks</label>
              <div class="input-field">
                <textarea name="remarks"
                          placeholder="Add any Remarks">{{ form.remarks.value }}</textarea>
              </div>
            </div>

            <!-- Tone -->
            <div class="tone-scope-group">
              <div class="input-group">
                <label class="top2-input">Tone of the Ad</label>
                <div class="input-field">
                  <select name="tone" required>
                    <option value="casual" {% if form.tone.value == 'casual' %}selected{% endif %}>Casual</option>
                    <option value="formal" {% if form.tone.value == 'formal' %}selected{% endif %}>Formal</option>
                    <option value="gen-z"  {% if form.tone.value == 'gen-z'  %}selected{% endif %}>Gen‑Z</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- CSV upload -->
            <div class="custom-file-upload">
              <label class="top2-input">Upload CSV File</label>
              <div class="input-field">
                <label for="fileInput" class="file-label">Choose File</label>
                <input type="file" name="csv_file" id="fileInput"
                       accept=".csv" onchange="updateFileName()" />
                <span class="file-name" id="fileName">{{ form.csv_file.value }}</span>
              </div>
            </div>

            <!-- Hashtag toggle -->
            <div class="toggle-section">
              <span>Include hashtags</span>
              <div class="toggle-switch">
                <input type="checkbox" name="include_hashtags" id="hashtags"
                       {% if form.include_hashtags.value %}checked{% endif %}/>
                <label for="hashtags"></label>
              </div>
            </div>

            <!-- Company name -->
            <div class="input-group">
              <div class="label-group">
                <label>Company name</label>
                <span class="optional">Optional</span>
              </div>
              <div class="input-field">
                <input type="text" name="company_name"
                       placeholder="Add company name"
                       value="{{ form.company_name.value }}" />
              </div>
            </div>

            <button type="submit" class="generate-btn">Generate post</button>
          </form>
        </section>
      </div>

      <!-- ─────────────── Right‑hand results pane ─────────────── -->
      <div class="illustration-section">
        {% if result %}
          <div class="generated-ads">
            <h2>Generated Ads:</h2>

            <!-- We post selection back to select_ads -->
            <form method="POST" action="{% url 'select_ads' campaign.id %}">
              {% csrf_token %}

              <div class="ad-content1">
                {% for ad in result %}
                  <div class="ad-edit-row">
                    <!-- radio: choose ONE ad -->
                    <input type="radio"
                           name="selected"
                           value="{{ forloop.counter }}"
                           id="sel_{{ forloop.counter }}"
                           class="ad-select"
                           {% if forloop.first %}checked{% endif %}>

                    <label for="sel_{{ forloop.counter }}" class="sr-only">
                      Choose ad {{ forloop.counter }}
                    </label>

                    <!-- editable copy -->
                    <textarea name="ad_{{ forloop.counter }}"
                              rows="2"
                              class="ad-textarea"
                              title="Editable ad content"
                              placeholder="Edit generated ad">{{ ad }}</textarea>
                  </div>
                {% endfor %}
              </div>

              <button type="submit" name="action" value="save" class="save-ads-btn">
                Save only
              </button>
              <button type="submit" name="action" value="send" class="send-ads-btn">
                Send Ads!
              </button>
            </form>
          </div>
        {% else %}
          <p>No ads available</p>
        {% endif %}
      </div>
    </div>
  </main>

  <script src="{% static 'user_auth/js/adjava.js' %}"></script>
</body>
</html>