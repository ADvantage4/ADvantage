CREATE TABLE weather_data (id SERIAL PRIMARY KEY,city VARCHAR(50),temperature DECIMAL(5, 2),condition VARCHAR(50),recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE location_data (location_id SERIAL PRIMARY KEY,postal_code VARCHAR(10) NOT NULL,city VARCHAR(50) NOT NULL,state VARCHAR(50),country VARCHAR(50) DEFAULT 'India');
CREATE TABLE users (user_id SERIAL PRIMARY KEY,name VARCHAR(100) NOT NULL,username VARCHAR(50) UNIQUE NOT NULL,email VARCHAR(100) UNIQUE NOT NULL,password_hash TEXT NOT NULL,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE subscriptions (subscription_id SERIAL PRIMARY KEY,user_id INT REFERENCES users(user_id) ON DELETE CASCADE,plan_name VARCHAR(50) NOT NULL CHECK (plan_name IN ('Free', 'Pro', 'Enterprise')),price DECIMAL(10, 2) NOT NULL,start_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,end_date TIMESTAMP NOT NULL,is_active BOOLEAN DEFAULT TRUE,payment_status VARCHAR(20) CHECK (payment_status IN ('pending', 'paid', 'failed')),transaction_id TEXT UNIQUE,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE transaction_history (transaction_id SERIAL PRIMARY KEY,user_id INT REFERENCES users(user_id) ON DELETE CASCADE,subscription_id INT REFERENCES subscriptions(subscription_id) ON DELETE SET NULL,amount DECIMAL(10, 2) NOT NULL,payment_method VARCHAR(50) CHECK (payment_method IN ('Credit Card', 'UPI', 'Net Banking', 'Wallet')),transaction_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,status VARCHAR(20) CHECK (status IN ('pending', 'completed', 'failed')));
CREATE TABLE ad_generation_history (ad_id SERIAL PRIMARY KEY,user_id INT REFERENCES users(user_id) ON DELETE CASCADE,ad_text TEXT NOT NULL,ad_image_url TEXT,generated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);